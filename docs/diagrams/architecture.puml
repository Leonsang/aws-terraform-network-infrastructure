@startuml Arquitectura del Sistema de Detecci贸n de Fraude

!define AWSPuml https://raw.githubusercontent.com/awslabs/aws-icons-for-plantuml/v16.0/dist
!include AWSPuml/AWSCommon.puml
!include AWSPuml/Storage/SimpleStorageService.puml
!include AWSPuml/Analytics/Glue.puml
!include AWSPuml/Analytics/Redshift.puml
!include AWSPuml/Analytics/Athena.puml
!include AWSPuml/Analytics/Kinesis.puml
!include AWSPuml/Compute/Lambda.puml
!include AWSPuml/Database/DynamoDB.puml
!include AWSPuml/ApplicationIntegration/SimpleNotificationService.puml
!include AWSPuml/ManagementGovernance/CloudWatch.puml
!include AWSPuml/Analytics/QuickSight.puml

skinparam linetype ortho
skinparam rectangle {
    BackgroundColor<<Raw>> LightYellow
    BackgroundColor<<Processed>> LightGreen
    BackgroundColor<<Analytics>> LightBlue
    BorderColor Black
    ArrowColor Black
}

' T铆tulo
title Arquitectura Lakehouse para Detecci贸n de Fraude Financiero

' Definir zonas
rectangle "Raw Zone (Bronze) " as RawZone <<Raw>> {
    SimpleStorageService(rawBucket, "Raw Bucket", "Datos sin procesar")
    Glue(rawCrawler, "Glue Crawler", "Catalogaci贸n")
}

rectangle "Processed Zone (Silver) " as ProcessedZone <<Processed>> {
    SimpleStorageService(processedBucket, "Processed Bucket", "Datos limpios")
    Glue(etlJob, "Glue ETL Job", "Transformaci贸n")
    Lambda(qualityCheck, "Lambda Quality", "Validaci贸n de calidad")
}

rectangle "Analytics Zone (Gold) " as AnalyticsZone <<Analytics>> {
    SimpleStorageService(analyticsBucket, "Analytics Bucket", "Vistas materializadas")
    Redshift(redshift, "Redshift Cluster", "Data Warehouse")
    Athena(athena, "Athena", "Consultas ad-hoc")
    QuickSight(quicksight, "QuickSight", "Dashboards")
}

' Ingesta de datos
rectangle "Ingesta de Datos" {
    Lambda(kaggleDownloader, "Kaggle Downloader", "Descarga autom谩tica")
    Kinesis(kinesisStream, "Kinesis Stream", "Ingesta en tiempo real")
    Lambda(realtimeProcessor, "Realtime Processor", "Procesamiento en tiempo real")
}

' Monitoreo
rectangle "Monitoreo y Alertas" {
    CloudWatch(cloudwatch, "CloudWatch", "M茅tricas y logs")
    SimpleNotificationService(sns, "SNS", "Notificaciones")
}

' Almacenamiento de estad铆sticas
DynamoDB(dynamodb, "DynamoDB", "Estad铆sticas de tarjetas")

' Flujo de datos - Batch
kaggleDownloader --> rawBucket : "Carga inicial"
rawBucket --> rawCrawler : "Catalogaci贸n"
rawCrawler --> etlJob : "Metadatos"
rawBucket --> etlJob : "Lectura"
etlJob --> qualityCheck : "Validaci贸n"
qualityCheck --> processedBucket : "Datos validados"
processedBucket --> analyticsBucket : "Agregaciones"
analyticsBucket --> redshift : "Carga"
analyticsBucket --> athena : "Consulta"
redshift --> quicksight : "Visualizaci贸n"
athena --> quicksight : "Visualizaci贸n"

' Flujo de datos - Tiempo real
kinesisStream --> realtimeProcessor : "Eventos"
realtimeProcessor --> dynamodb : "Actualizaci贸n"
realtimeProcessor --> processedBucket : "Almacenamiento"
realtimeProcessor --> sns : "Alertas de fraude"

' Monitoreo
etlJob ..> cloudwatch : "Logs y m茅tricas"
qualityCheck ..> cloudwatch : "Logs y m茅tricas"
realtimeProcessor ..> cloudwatch : "Logs y m茅tricas"
cloudwatch --> sns : "Alertas"

@enduml 